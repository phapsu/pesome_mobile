<!DOCTYPE html><html>    <head>        <title>Pesome</title>        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />        <meta name="viewport" content="width=device-width, initial-scale=1">        <meta name="apple-mobile-web-app-capable" content="yes">        <meta name="description" content="Personal Social Media">        <link rel="stylesheet" href="css/jquery.mobile-1.2.0.min.css" />        <link rel="stylesheet" href="css/pesome.css" />        <script src="js/jquery-1.8.3.min.js"></script>        <script src="js/json2.js"></script>        <script src="js/jquery.base64.min.js"></script>        <script src="js/jquery.mobile-1.2.0.min.js"></script>        <script src="js/pesome/common.js"></script>        <script src="cordova-2.2.0.js"></script>        <script type="text/javascript" charset="utf-8">            var pictureSource;   // picture source            var destinationType; // sets the format of returned value             // Wait for PhoneGap to connect with the device            //            document.addEventListener("deviceready",onDeviceReady,false);            // PhoneGap is ready to be used!            //            function onDeviceReady() {                pictureSource=navigator.camera.PictureSourceType;                destinationType=navigator.camera.DestinationType;            }            // Called when a photo is successfully retrieved            //            function onPhotoDataSuccess(imageData) {                // Uncomment to view the base64 encoded image data                               console.log(imageData);                // Get image handle                //                var smallImage = document.getElementById('smallImage');                // Unhide image elements                //                smallImage.style.display = 'block';                // Show the captured photo                // The inline CSS rules are used to resize the image                //                smallImage.src = "data:image/jpeg;base64," + imageData;            }            // Called when a photo is successfully retrieved            //            function onPhotoURISuccess(imageURI) {                // Uncomment to view the image file URI                 console.log(imageURI);                // Get image handle                //                var largeImage = document.getElementById('largeImage');                // Unhide image elements                //                largeImage.style.display = 'block';                // Show the captured photo                // The inline CSS rules are used to resize the image                //                largeImage.src = imageURI;            }            // A button will call this function            //            function capturePhoto() {                // Take picture using device camera and retrieve image as base64-encoded string                navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50 });            }            // A button will call this function            //            function capturePhotoEdit() {                // Take picture using device camera, allow edit, and retrieve image as base64-encoded string                  navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 20, allowEdit: true });             }            // A button will call this function            //            function getPhoto(source) {                // Retrieve image file location from specified source                navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50,                     destinationType: destinationType.FILE_URI,                    sourceType: source });            }            // Called if something bad happens.            //             function onFail(message) {                alert('Failed because: ' + message);            }/*=============================================================================================*/                function getAndSavePhoto(){                 navigator.camera.getPicture(photoSave, onFail, { quality: 50, destinationType: navigator.camera.DestinationType.FILE_URI });             }             server =  'http://dev.afterclassroom.com/api/petopics/create_photo';            function photoSave(imageURI) {                 if (server) {                    // Specify transfer options                    var options = new FileUploadOptions();                    options.fileKey="file";                    options.fileName=imageURI;//imageURI.substr(imageURI.lastIndexOf('/')+1);                    options.mimeType="image/jpeg";                    options.chunkedMode = false;                    var params = new Object();                    //params.headers = {'Authorization' : 'Bearer c75d3fd6194cf87c552877d7c6cddf22'};                    params.id = "321";                    params.photo_album_id = "207";                    params.title = "My Capture Image";                    params.photo = imageBase64Data;                    options.params = params;                    // Transfer picture to server                    var ft = new FileTransfer();                    ft.upload(imageURI, server, function(r) {                        l("Upload successful: "+r.bytesSent+" bytes uploaded.");                    }, function(error) {                        l("Upload failed: Code = "+error.code);                    }, options);                }                               // this relies on knowledge of photo file URI - you might want to make this more robust :-)                //doGetFile(imageURI);                            }                         // file system fail             function fsFail(error) {                 console.log("failed with error code: " + error.code);             };                                     function doGetFile(imageURI){                window.resolveLocalFileSystemURI(imageURI, gotFS, fail);                            }                        function gotFS(fileEntry) {                console.log(">>>>IMG PATH: " + fileEntry.name);                 fileEntry.file(gotFile, fail);            }                                               function gotFile(file){                var imageBase64Data;                var reader = new FileReader();                reader.onloadend = function(evt) {                    console.log("Read as text");                    //imageData = $.base64.encode(evt.target.result);                     console.log('>>>>>Upload to server<<<<');                    imageBase64Data = evt.target.result;                                             var options = new FileUploadOptions();                    options.fileKey="file";                    options.fileName=file;//imageURI.substr(imageURI.lastIndexOf('/')+1);                    options.mimeType="image/jpeg";                    options.chunkedMode = false;                    var params = new Object();                    //params.headers = {'Authorization' : 'Bearer c75d3fd6194cf87c552877d7c6cddf22'};                    params.id = "321";                    params.photo_album_id = "207";                    params.title = "My Capture Image";                    params.photo = imageBase64Data;                    options.params = params;                    // Transfer picture to server                    var ft = new FileTransfer();                    ft.upload(file, server, function(r) {                        l("Upload successful: "+r.bytesSent+" bytes uploaded.");                    }, function(error) {                        l("Upload failed: Code = "+error.code);                    }, options);                                     };                reader.readAsText(file);            }            function fail(evt) {                console.log(evt.target.error.code);            }                  </script>    </head>    <body>        <button onclick="getAndSavePhoto();">Capture Photo</button> <br>        <button onclick="doGetFile();">Capture Editable Photo</button> <br>        <button onclick="getPhoto(pictureSource.PHOTOLIBRARY);">From Photo Library</button><br>        <button onclick="getPhoto(pictureSource.SAVEDPHOTOALBUM);">From Photo Album</button><br>        <img style="display:none;width:60px;height:60px;" id="smallImage" src="" />        <img style="display:none;" id="largeImage" src="" />    </body></html>