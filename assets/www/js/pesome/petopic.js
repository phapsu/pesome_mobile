$('#page-petopic').bind('pageinit', function(event) {               $.fn.petopic = function(config){        config = $.extend({}, {            loadURL : null,            callback: function() {}        }, config);        //check content        if(config.loadURL == null || config.loadURL == undefined){            return false;        }        $.mobile.loading('show');        // initial container object        var $container = $(this);        $.ajax({            url: config.loadURL,            dataType: "jsonp",            contentType: "application/json",            async: false,            success: function (data) {                $tmpl = "";                                if(data!='')                {                    $.each(data, function(i, item) {                        var id =  item.petopic.id;                        var description =  item.petopic.description;                        var title =  item.petopic.title;                        var thumbnail =  item.petopic.thumbnail;                        description = (description.length > 100) ? description.substring(1, 100) : description;                        $tmpl += "<li><span class='icone-home'>"                        +'<a data-mini="true" data-inline="true" data-role="button" data-icon="eye-open" href="index.html" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-theme="c" class="ui-btn ui-shadow ui-btn-corner-all ui-mini ui-btn-inline ui-btn-icon-left ui-btn-up-c"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Follow</span><span class="ui-icon ui-icon-eye-open ui-icon-shadow">&nbsp;</span></span></a>'                        +'<a data-mini="true" data-inline="true" data-role="button" data-icon="plus" href="index.html" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-theme="c" class="ui-btn ui-shadow ui-btn-corner-all ui-mini ui-btn-inline ui-btn-icon-left ui-btn-up-c"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Add Me In</span><span class="ui-icon ui-icon-plus ui-icon-shadow">&nbsp;</span></span></a>'                        +'</span>'                        +"<a class='ui-link-inherit' href=\"petopic_detail.html?id="+id+"\"><img width='160px' height='160px' src=\""+$full_base_url+thumbnail+"\" /><h5>"+title+"</h5><br/><p>"+description+"</p></a></li>";                    });                    $container.html($tmpl).listview('refresh');                }                else{                    window.location.href="sorry.html";                }                                $.mobile.loading('hide');            },            error: function(e) {                console.log(e.message);            }        });    }    //load thong tin user    $.ajax({        url: $api_url.me(),        dataType: "jsonp",        contentType: "application/json",        async: false,        success: function (data) {            var user = data.user;            $('#avatar').attr('src', $full_base_url + user.image);            $('#username').text(user.name);            $('#a_logout').attr('href', 'logout('+user.id+')');                   },        error: function(e) {            console.log(e.message);        }    });      //load all category    $('#listposts').petopic({        loadURL : $api_url.petopic()    });                    $("#list_category").niceScroll({        cursorborder:"",        cursorcolor:"#ccc",        boxzoom:true,        touchbehavior:true    }); // First scrollable DIV            //load list category    $.ajax({        url: $api_url.category(),        dataType: "jsonp",        contentType: "application/json",        async: false,        success: function (data) {            var $tmpl = "";                 $.each(data, function(i, item) {                              $tmpl += '<li><a href="" onclick="javascript:opencategory('+"'"+item.category_obj.id+"','"+item.category_obj.name+"'"+')">'+item.category_obj.name+'</a></li>';            });            $('#list_category').html($tmpl).listview('refresh');        },        error: function(e) {            console.log(e.message);        }    });           /*    var $container = $("#listposts");        var petopic = {        load : function(offset){            offset = (offset == 'undefined') ? 1 : offset;            offset = parseInt(offset);            $.ajax({                url: $api_url.petopic(),                data: {'page' : offset},                dataType: "jsonp",                contentType: "application/json",                async: false,                    success: function(res){                    $('#loader').fadeOut('fast', function(){                        $("#tmplPetopic").tmpl( res ).appendTo("#listposts");                                            });//                    $container.isotope({//                        itemSelector : '.entry'//                    });                },                error: function(e) {                    l(e.message);                }            });        }    };            var $currentPage = 0;   // petopic.load($currentPage);    $currentPage = 1;            $container.scrollPagination({        'contentPage': 'blank.html', // the url you are fetching the results        'contentData': {}, // these are the variables you can pass to the request, for example: children().size() to know which page you are        'scrollTarget': $(window), // who gonna scroll? in this example, the full window        'heightOffset': 10, // it gonna request when scroll is 10 pixels before the page ends        'beforeLoad': function(){ // before load function, you can display a preloader div            $('#loader').fadeIn();        },        'afterLoad': function(elementsLoaded){            l($currentPage);            //$currentPage = ($currentPage > 1) ? $currentPage - 1 : $currentPage;            petopic.load($currentPage);            $currentPage += 1;        }    });     *     */});function opencategory(category_id, name){    $('#listposts').petopic({        loadURL : $api_url.petopic()+'&category_id='+category_id    });                           $('#msg').html('');    $('#msg').append(name).show();    $('.pe-category').hide();    $("#popupMenu").popup("close");        }