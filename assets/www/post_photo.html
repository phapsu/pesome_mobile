<!DOCTYPE html><html>    <head>        <title>Pesome</title>        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />        <meta name="viewport" content="width=device-width, initial-scale=1">        <meta name="apple-mobile-web-app-capable" content="yes">        <meta name="description" content="Personal Social Media">        <link rel="stylesheet" href="css/jquery.mobile-1.2.0.min.css" />        <link rel="stylesheet" href="css/pesome.css" />        <script src="js/jquery-1.8.3.min.js"></script>        <script src="js/json2.js"></script>        <script src="js/jquery.base64.min.js"></script>        <script src="js/jquery.mobile-1.2.0.min.js"></script>        <script src="js/pesome/common.js"></script>        <script src="cordova-2.2.0.js"></script>        <script type="text/javascript" charset="utf-8">            document.addEventListener("deviceready",this.deviceready,false);                        /**             * Take picture with camera and retrieve image file location:             */            function takePicture() {                navigator.camera.getPicture(                function(uri) {                    var img = document.getElementById('camera_image');                    img.style.visibility = "visible";                    img.style.display = "block";                    img.src = uri;                    document.getElementById('camera_status').innerHTML = "Success";                },                function(e) {                    console.log("Error getting picture: " + e);                    document.getElementById('camera_status').innerHTML = "Error getting picture.";                },                { quality: 50, destinationType: navigator.camera.DestinationType.FILE_URI});            };            /**             * Select picture from library             */            function selectPicture() {                navigator.camera.getPicture(                function(uri) {                    var img = document.getElementById('camera_image');                    img.style.visibility = "visible";                    img.style.display = "block";                    img.src = uri;                    document.getElementById('camera_status').innerHTML = "Success";                },                function(e) {                    console.log("Error getting picture: " + e);                    document.getElementById('camera_status').innerHTML = "Error getting picture.";                },                { quality: 50, destinationType: navigator.camera.DestinationType.FILE_URI, sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY});            };            /**             * Upload current picture             */            function uploadPicture() {                // Get URI of picture to upload                var img = document.getElementById('camera_image');                var imageURI = img.src;                if (!imageURI || (img.style.display == "none")) {                    document.getElementById('camera_status').innerHTML = "Take picture or select picture from library first.";                    return;                }                var options = new FileUploadOptions();                options.fileKey="file";                options.fileName=imageURI;//imageURI.substr(imageURI.lastIndexOf('/')+1);                options.mimeType="image/jpeg";                options.chunkedMode = false;                var params = new Object();                //params.headers = {'Authorization' : 'Bearer c75d3fd6194cf87c552877d7c6cddf22'};                params.id = "321";                params.photo_album_id = "207";                params.title = "My Capture Image";                               options.params = params;                // Transfer picture to server                //var server =  'http://dev.afterclassroom.com/api/petopics/create_photo';                var server =  'http://crownfire.onlyoneweb.com/mobile/upload.php';                var ft = new FileTransfer();                ft.upload(imageURI, server, function(r) {                    document.getElementById('camera_status').innerHTML = "Upload successful: "+r.bytesSent+" bytes uploaded.";                }, function(error) {                    document.getElementById('camera_status').innerHTML = "Upload failed: Code = "+error.code;                }, options);//               doGetFile(imageURI);            }            function doGetFile(imageURI){                window.resolveLocalFileSystemURI(imageURI, gotFS, fail);            }            function gotFS(fileEntry) {                console.log(">>>>IMG PATH: " + fileEntry.fullPath);                fileEntry.file(gotFile, fail);            }            function gotFile(file){                var imageBase64Data;                var reader = new FileReader();                reader.onloadend = function(evt) {                    console.log("Read as text");                    //imageData = $.base64.encode(evt.target.result);                    imageBase64Data = evt.target.result;                    console.log('>>>>>'+Base64.encode(imageBase64Data)+'<<<<');                    var options = new FileUploadOptions();                    options.fileKey="file";                    options.fileName=file;//imageURI.substr(imageURI.lastIndexOf('/')+1);                    options.mimeType="image/jpeg";                    options.chunkedMode = false;                    var params = new Object();                    //params.headers = {'Authorization' : 'Bearer c75d3fd6194cf87c552877d7c6cddf22'};                    params.id = "321";                    params.photo_album_id = "207";                    params.title = "My Capture Image";                    params.photo = Base64.encode(imageBase64Data);                    options.params = params;                    // Transfer picture to server                    var ft = new FileTransfer();                             var server =  'http://crownfire.onlyoneweb.com/mobile/upload.php';                    ft.upload(imageURI, server, function(r) {                        document.getElementById('camera_status').innerHTML = "Upload successful: "+r.bytesSent+" bytes uploaded.";                    }, function(error) {                        document.getElementById('camera_status').innerHTML = "Upload failed: Code = "+error.code;                    }, options);                };                reader.readAsText(file);            }            function fail(evt) {                console.log('>>>EROROR CODE:'+evt.target.error.code);            }            /**             * View pictures uploaded to the server             */            function viewUploadedPictures() {                // Get server URL                      var server =  'http://crownfire.onlyoneweb.com/mobile/upload.php';                if (server) {                    // Get HTML that lists all pictures on server using XHR                    var xmlhttp = new XMLHttpRequest();                    // Callback function when XMLHttpRequest is ready                    xmlhttp.onreadystatechange=function(){                        if(xmlhttp.readyState === 4){                            // HTML is returned, which has pictures to display                            if (xmlhttp.status === 200) {                                document.getElementById('server_images').innerHTML = xmlhttp.responseText;                            }                            // If error                            else {                                document.getElementById('server_images').innerHTML = "Error retrieving pictures from server.";                            }                        }                    };                    xmlhttp.open("GET", server , true);                    xmlhttp.send();                }            }        </script>    </head>    <body>        <div id="postPetick" data-role="page" data-title="Get My Token"  data-add-back-btn="true">            <!-- Header -->            <div data-role="header" class="header">                <h4>Pesome Upload</h4>            </div><!-- END OF: Header -->            <!-- Wrapper -->            <div data-role="content"><!--                <div>                    <h3>Server URL for upload.php:</h3>                    <input id="serverUrl" type="text" value="http://crownfire.onlyoneweb.com/mobile/upload.php" />                </div>                <br/>-->                <!-- Camera -->                <div>                    <h3>Camera:</h3>                    <b>Status:</b> <span id="camera_status"></span><br>                    <b>Image:</b> <img style="width:120px;visibility:hidden;display:none;" id="camera_image" src="" />                </div>                <!-- Actions -->                <div>                    <input type="button" onclick="takePicture();" value="Take Picture" /><br/>                    <input type="button" onclick="selectPicture();" value="Select Picture from Library" /><br/>                    <input type="button" onclick="uploadPicture();" value="Upload Picture" />                </div>                <br/>                <!-- Server pictures -->                <div>                    <h3>Server:</h3>                    <b>Images on server:</b>                    <div id="server_images"></div>                </div>                <!-- Actions -->                <div>                    <input type="button" onclick="viewUploadedPictures();" value="View Uploaded Pictures" />                </div>            </div>        </div>    </body></html>